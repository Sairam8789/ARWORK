<!DOCTYPE html>
<html>
<head>
    <title>AR Mode with Planes and Object Placement in Babylon.js</title>
    <script src="https://cdn.babylonjs.com/babylon.js"></script>
    <script src="https://cdn.babylonjs.com/loaders/babylonjs.loaders.min.js"></script>
    <script src="https://preview.babylonjs.com/xr/pebble.js"></script>
</head>
<body>
    <canvas id="renderCanvas"></canvas>
    <script>
        window.addEventListener('DOMContentLoaded', function () {
            var canvas = document.getElementById('renderCanvas');
            var engine = new BABYLON.Engine(canvas, true);

            var createScene = async function () {
                var scene = new BABYLON.Scene(engine);
                scene.clearColor = new BABYLON.Color3(0.8, 0.8, 0.8);

                // AR Experience
                var xr = await scene.createDefaultXRExperienceAsync({
                    uiOptions: {
                        sessionMode: 'immersive-ar',
                        referenceSpaceType: 'local',
                    },
                });

                // Create Planes
                var plane1 = BABYLON.MeshBuilder.CreatePlane("plane1", { size: 1 }, scene);
                plane1.position.x = -0.5;

                var plane2 = BABYLON.MeshBuilder.CreatePlane("plane2", { size: 1 }, scene);
                plane2.position.x = 0.5;

                // Create Objects
                var box1 = BABYLON.MeshBuilder.CreateBox("box1", { size: 0.2 }, scene);
                box1.position.y = 0.1;

                var box2 = BABYLON.MeshBuilder.CreateBox("box2", { size: 0.2 }, scene);
                box2.position.y = 0.1;

                // Parent objects to planes
                box1.parent = plane1;
                box2.parent = plane2;

                return scene;
            };

            createScene().then(scene => {
                // Start the render loop
                engine.runRenderLoop(function () {
                    scene.render();
                });

                // Handle window resize
                window.addEventListener('resize', function () {
                    engine.resize();
                });
            });
        });
    </script>
</body>
</html>
